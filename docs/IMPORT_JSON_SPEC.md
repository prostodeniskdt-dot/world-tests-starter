# Спецификация JSON для импорта тестов

Документ для **ИИ-агента** и разработчиков: как генерировать JSON, чтобы импорт на сайте проходил без ошибок валидации.

## Обязательные поля верхнего уровня

| Поле | Тип | Описание |
|------|-----|----------|
| `title` | строка | Название теста (обязательно). Не `test_name`! |
| `questions` | массив | Непустой массив вопросов |
| `answerKey` | объект | Ключ ответов: `{ "id_вопроса": правильный_ответ }` |

Опционально: `id`, `description`, `category`, `difficultyLevel`, `basePoints`, `maxAttempts`.

## Структура каждого вопроса

| Поле | Тип | Обязательно | Описание |
|------|-----|-------------|----------|
| `id` | строка | да | Уникальный идентификатор (например `"q1"`, `"q2"`). Должен совпадать с ключом в `answerKey`. |
| `type` | строка | да | Один из допустимых типов (см. ниже). |
| `text` | строка | да | Текст вопроса. Не `question`! |

Тип вопроса задаёт дополнительные поля (options, gaps, leftItems/rightItems, items и т.д.).

## Допустимые значения `type`

Используйте **ровно** эти строки (с дефисами, без подчёркиваний):

- `multiple-choice` — один правильный ответ
- `multiple-select` — несколько правильных ответов
- `true-false-enhanced` — верно/неверно + выбор причины
- `cloze-dropdown` — заполнение пропусков в тексте
- `select-errors` — выбор ошибок в тексте
- `matching` — сопоставление левых и правых элементов
- `ordering` — упорядочивание элементов
- `two-step` — двухступенчатый вопрос
- `matrix` — матрица
- `grouping` — группировка по категориям

**Частые ошибки агента:**  
`single_choice` → нужно `multiple-choice`  
`true_false` → нужно `true-false-enhanced`  
`cloze` → нужно `cloze-dropdown`  
`scenario` (как тип) → для «сценариев» с одним ответом используйте `multiple-choice`  
`multiple_choice` → нужно `multiple-choice`

## Формат `answerKey`

Объект: ключ = `id` вопроса (строка), значение = правильный ответ в формате, зависящем от типа:

| Тип | Формат ответа | Пример |
|-----|----------------|--------|
| `multiple-choice` | число (индекс варианта, с 0) | `0` |
| `multiple-select` | массив индексов | `[0, 2, 3]` |
| `true-false-enhanced` | `{ "answer": true/false, "reason": число }` | `{ "answer": false, "reason": 1 }` |
| `cloze-dropdown` | массив индексов (по одному на каждый пропуск) | `[1, 0]` |
| `matching` | массив пар `[индекс_слева, индекс_справа]` | `[[0, 0], [1, 1], [2, 2]]` |
| `ordering` | массив индексов в правильном порядке | `[0, 1, 2, 3]` |

Индексы везде **с нуля** (первый вариант = 0).

## Специфика по типам вопросов

### multiple-choice
- `options`: массив строк.

### multiple-select
- `options`: массив строк.

### true-false-enhanced
- `statement`: строка (утверждение).
- `reasons`: массив строк (варианты причин). В `answerKey` для этого вопроса: `{ "answer": true|false, "reason": индекс_причины }`.

### cloze-dropdown
- `text`: строка с пропусками в формате `[1]`, `[2]` или `___`, `{0}`, `{1}`. Нумерация `[1]` соответствует первому элементу в `gaps` (индекс 0).
- `gaps`: массив `{ "index": number, "options": string[] }` — по одному на каждый пропуск.

### matching
- `leftItems`: массив строк (левая колонка).
- `rightItems`: массив строк (правая колонка).
- В `answerKey`: массив пар `[[leftIndex, rightIndex], ...]` в любом порядке.

### ordering
- `items`: массив строк (элементы для упорядочивания).
- В `answerKey`: массив индексов в правильном порядке, например `[0, 1, 2, 3]`.

## Пример готового JSON

Полный пример с разными типами вопросов: **[import-format-example.json](./import-format-example.json)** в этой же папке. Импортируйте его на странице «Импорт теста», чтобы проверить механику.

## Краткий чек-лист для агента

1. Использовать поле **`title`**, а не `test_name`.
2. В каждом вопросе использовать поле **`text`**, а не `question`.
3. Типы писать **с дефисами**: `multiple-choice`, `true-false-enhanced`, `cloze-dropdown` и т.д.
4. Добавить верхний уровень **`answerKey`** — объект с ключами = `id` вопросов и значениями в формате по таблице выше.
5. Для matching передавать **`leftItems`** и **`rightItems`** (массивы), а не объект `pairs`; ответ в `answerKey` — массив пар индексов `[[0,0],[1,1],...]`.
6. Для ordering ответ в `answerKey` — массив индексов в правильном порядке, а не отдельное поле в вопросе.

После генерации JSON можно вставить его на странице импорта и нажать «Проверить» — все ошибки валидации соответствуют этой спецификации.
